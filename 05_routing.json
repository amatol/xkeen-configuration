{
  "routing": {
    "domainStrategy": "IPIfNonMatch",
    "rules": [
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "block",
        "network": "udp",
        "port": "135,137,138,139"
      },
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "block",
        "network": "udp",
        "port": "443",
        "ip": [
          "ext:geoip_zkeenip.dat:!ru"
        ]
      },
      {	
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "vless-reality",
        "type": "field",
        "domain": ["ext:geosite_v2fly.dat:whatsapp"],
        "network": "udp"
       },	
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "vless-reality",
        "domain": [
          "ext:geosite_zkeen.dat:domains",
          "ext:geosite_zkeen.dat:other",
          "ext:geosite_zkeen.dat:youtube",
          "user.auth.xboxlive.com",
          "xsts.auth.xboxlive.com",
          "gql.twitch.tv",
          "api.srvkp.com",
          "gomining.com",
          "app.gmt.io",
          "ttvnw.net"
        ]
      },
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "vless-reality",
        "ip": [
          "ext:geoip_zkeenip.dat:discord",
          "ext:geoip_zkeenip.dat:meta",
          "ext:geoip_zkeenip.dat:telegram"
        ]
      },
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "direct",
        "protocol": [
          "bittorrent"
        ]
      },
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "direct",
        "ip": [
          "127.0.0.0/8",
          "10.0.0.0/8",
          "172.16.0.0/12",
          "192.168.0.0/16",
          "169.254.0.0/16"
        ]
      },
      {
        "type": "field",
        "inboundTag": ["redirect", "tproxy"],
        "outboundTag": "direct",
        "network": "tcp,udp"
      }
    ]
  }
}
